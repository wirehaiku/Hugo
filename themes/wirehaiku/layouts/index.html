{{ define "main" }}
{{ $posts := (where .Site.RegularPages "Type" "posts") | first 11  }}

<article>
    {{ with .Site.Params.alert }}
        <div class="alert">
            {{ . | $.RenderString }}
        </div>
    {{ end }}

    {{ .Site.Params.intro | safeHTML }}
    
    {{ with index $posts 0 }}
        {{ $a := split .Content "<code>" }}
        {{ $b := split (index $a 1) "</code>" }}
        {{ $c := index $b 0 | htmlUnescape }}
        {{ if ne $c "" }}
            <div class="index">
                <h2> Latest Post: <a href="{{ .RelPermalink }}">{{ .Title }}</a> </h2> 
                <pre><code>{{ $c }}</code></pre>
                <p> <a href="{{ .RelPermalink }}">Read more &rarr;</a> </p>
            </div>
        {{ end }}
    {{ end }}

    <div class="index">
        <h2> Latest <a href="/posts/">Archives</a> </h2>
        <ul>
            {{ range after 1 $posts }}
                <li> 
                    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                    <span class="meta">{{ .Date.Format "2 January 2006" }}</span> 
                </li>
            {{ end }}
        </ul>
    </div>
</article>

{{ end }}
