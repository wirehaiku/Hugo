{{ define "main" }}
{{ $posts := (where .Site.RegularPages "Type" "posts") | first 11  }}

<article>
    {{ .Site.Params.intro | safeHTML }}

    {{ with index $posts 0 }}
    <h2> Latest Post: <a href="{{ .RelPermalink }}">{{ .Title }}</a> </h2>

    {{ $a := split .Content "<code>" }}
    {{ $b := split (index $a 1) "</code>" }}
    {{ $c := index $b 0 | htmlUnescape }}
    {{ if ne $c "" }}
    <pre><code>{{ $c }}</code></pre>
    {{ .Summary }}

    {{ end }}

    <p> <a href="{{ .RelPermalink }}">Read more &rarr;</a> </p>
    {{ end }}

    <div>
        <h2> Latest <a href="/posts/">Archives</a> </h2>
        <ul>
            {{ range after 1 $posts }}
            <li>
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                <span class="meta">{{ .Date.Format "2 January 2006" }}</span>
            </li>
            {{ end }}
        </ul>
    </div>
</article>

{{ end }}
